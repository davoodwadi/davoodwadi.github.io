<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Davood Wadi - SVD</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Davood Wadi</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-courses" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Courses</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-courses">    
        <li>
    <a class="dropdown-item" href="https://professional.mit.edu/course-catalog/applied-data-science-program-leveraging-ai-effective-decision-making" rel="" target="">
 <span class="dropdown-text">MIT ADSP</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./courses.html" rel="" target="">
 <span class="dropdown-text">MATH60629A</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#activesgd" id="toc-activesgd" class="nav-link active" data-scroll-target="#activesgd">activeSGD</a></li>
  <li><a href="#get-recommendations" id="toc-get-recommendations" class="nav-link" data-scroll-target="#get-recommendations">Get recommendations</a></li>
  <li><a href="#visualize-embeddings" id="toc-visualize-embeddings" class="nav-link" data-scroll-target="#visualize-embeddings">Visualize embeddings</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">SVD</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p><a href="https://colab.research.google.com/github/davoodwadi/davoodwadi.github.io/blob/main/SVD_movielens100k.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"></a></p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-outputid="6953b61a-adc9-48ed-e607-a600245528a4" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>wget <span class="st">'https://files.grouplens.org/datasets/movielens/ml-100k.zip'</span> <span class="st">'./'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>--2023-09-25 12:22:25--  https://files.grouplens.org/datasets/movielens/ml-100k.zip
Resolving files.grouplens.org (files.grouplens.org)... 128.101.65.152
Connecting to files.grouplens.org (files.grouplens.org)|128.101.65.152|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 4924029 (4.7M) [application/zip]
Saving to: ‘ml-100k.zip’

ml-100k.zip         100%[===================&gt;]   4.70M  9.91MB/s    in 0.5s    

2023-09-25 12:22:26 (9.91 MB/s) - ‘ml-100k.zip’ saved [4924029/4924029]

--2023-09-25 12:22:26--  http://./
Resolving . (.)... failed: No address associated with hostname.
wget: unable to resolve host address ‘.’
FINISHED --2023-09-25 12:22:26--
Total wall clock time: 1.0s
Downloaded: 1 files, 4.7M in 0.5s (9.91 MB/s)</code></pre>
</div>
</div>
<div class="cell" data-outputid="9effa0de-b285-4944-9a4f-c5c4f084105d" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>unzip <span class="st">'./ml-100k.zip'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Archive:  ./ml-100k.zip
   creating: ml-100k/
  inflating: ml-100k/allbut.pl       
  inflating: ml-100k/mku.sh          
  inflating: ml-100k/README          
  inflating: ml-100k/u.data          
  inflating: ml-100k/u.genre         
  inflating: ml-100k/u.info          
  inflating: ml-100k/u.item          
  inflating: ml-100k/u.occupation    
  inflating: ml-100k/u.user          
  inflating: ml-100k/u1.base         
  inflating: ml-100k/u1.test         
  inflating: ml-100k/u2.base         
  inflating: ml-100k/u2.test         
  inflating: ml-100k/u3.base         
  inflating: ml-100k/u3.test         
  inflating: ml-100k/u4.base         
  inflating: ml-100k/u4.test         
  inflating: ml-100k/u5.base         
  inflating: ml-100k/u5.test         
  inflating: ml-100k/ua.base         
  inflating: ml-100k/ua.test         
  inflating: ml-100k/ub.base         
  inflating: ml-100k/ub.test         </code></pre>
</div>
</div>
<div class="cell" data-outputid="cd397b1f-3282-46ed-9770-ea226600aa39" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>movie_columns <span class="op">=</span> [<span class="st">'movie id'</span> , <span class="st">'movie title'</span> , <span class="st">'release date'</span> , <span class="st">'video release date'</span> ,</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>              <span class="st">'IMDb URL'</span> , <span class="st">'unknown'</span> , <span class="st">'Action'</span> , <span class="st">'Adventure'</span> , <span class="st">'Animation'</span> ,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Children's"</span> , <span class="st">'Comedy'</span> , <span class="st">'Crime'</span> , <span class="st">'Documentary'</span> , <span class="st">'Drama'</span> , <span class="st">'Fantasy'</span> ,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>              <span class="st">'Film-Noir'</span> , <span class="st">'Horror'</span> , <span class="st">'Musical'</span> , <span class="st">'Mystery'</span> , <span class="st">'Romance'</span> , <span class="st">'Sci-Fi'</span> ,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>              <span class="st">'Thriller'</span> , <span class="st">'War'</span> , <span class="st">'Western'</span> ]</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>movies <span class="op">=</span> pd.read_csv(<span class="st">'./ml-100k/u.item'</span>, sep<span class="op">=</span><span class="st">'|'</span>, encoding<span class="op">=</span><span class="st">'latin-1'</span>, names <span class="op">=</span> movie_columns)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>movies</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">

  <div id="df-ed199a1e-0b98-4c8c-be57-e01e5b92ca42" class="colab-df-container">
    <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">movie id</th>
<th data-quarto-table-cell-role="th">movie title</th>
<th data-quarto-table-cell-role="th">release date</th>
<th data-quarto-table-cell-role="th">video release date</th>
<th data-quarto-table-cell-role="th">IMDb URL</th>
<th data-quarto-table-cell-role="th">unknown</th>
<th data-quarto-table-cell-role="th">Action</th>
<th data-quarto-table-cell-role="th">Adventure</th>
<th data-quarto-table-cell-role="th">Animation</th>
<th data-quarto-table-cell-role="th">Children's</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">Fantasy</th>
<th data-quarto-table-cell-role="th">Film-Noir</th>
<th data-quarto-table-cell-role="th">Horror</th>
<th data-quarto-table-cell-role="th">Musical</th>
<th data-quarto-table-cell-role="th">Mystery</th>
<th data-quarto-table-cell-role="th">Romance</th>
<th data-quarto-table-cell-role="th">Sci-Fi</th>
<th data-quarto-table-cell-role="th">Thriller</th>
<th data-quarto-table-cell-role="th">War</th>
<th data-quarto-table-cell-role="th">Western</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>Toy Story (1995)</td>
<td>01-Jan-1995</td>
<td>NaN</td>
<td>http://us.imdb.com/M/title-exact?Toy%20Story%2...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2</td>
<td>GoldenEye (1995)</td>
<td>01-Jan-1995</td>
<td>NaN</td>
<td>http://us.imdb.com/M/title-exact?GoldenEye%20(...</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3</td>
<td>Four Rooms (1995)</td>
<td>01-Jan-1995</td>
<td>NaN</td>
<td>http://us.imdb.com/M/title-exact?Four%20Rooms%...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4</td>
<td>Get Shorty (1995)</td>
<td>01-Jan-1995</td>
<td>NaN</td>
<td>http://us.imdb.com/M/title-exact?Get%20Shorty%...</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5</td>
<td>Copycat (1995)</td>
<td>01-Jan-1995</td>
<td>NaN</td>
<td>http://us.imdb.com/M/title-exact?Copycat%20(1995)</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1677</td>
<td>1678</td>
<td>Mat' i syn (1997)</td>
<td>06-Feb-1998</td>
<td>NaN</td>
<td>http://us.imdb.com/M/title-exact?Mat%27+i+syn+...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1678</td>
<td>1679</td>
<td>B. Monkey (1998)</td>
<td>06-Feb-1998</td>
<td>NaN</td>
<td>http://us.imdb.com/M/title-exact?B%2E+Monkey+(...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1679</td>
<td>1680</td>
<td>Sliding Doors (1998)</td>
<td>01-Jan-1998</td>
<td>NaN</td>
<td>http://us.imdb.com/Title?Sliding+Doors+(1998)</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1680</td>
<td>1681</td>
<td>You So Crazy (1994)</td>
<td>01-Jan-1994</td>
<td>NaN</td>
<td>http://us.imdb.com/M/title-exact?You%20So%20Cr...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1681</td>
<td>1682</td>
<td>Scream of Stone (Schrei aus Stein) (1991)</td>
<td>08-Mar-1996</td>
<td>NaN</td>
<td>http://us.imdb.com/M/title-exact?Schrei%20aus%...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>


<p>1682 rows × 24 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-ed199a1e-0b98-4c8c-be57-e01e5b92ca42')" title="Convert this dataframe to an interactive table." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-ed199a1e-0b98-4c8c-be57-e01e5b92ca42 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-ed199a1e-0b98-4c8c-be57-e01e5b92ca42');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-3e37f0bb-715f-4640-9055-6b006de31731">
  <button class="colab-df-quickchart" onclick="quickchart('df-3e37f0bb-715f-4640-9055-6b006de31731')" title="Suggest charts." style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"></path>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-3e37f0bb-715f-4640-9055-6b006de31731 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div>
</div>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>genres <span class="op">=</span> movies.columns[<span class="dv">6</span>:].to_numpy()</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_genre(row):</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  genre_int <span class="op">=</span> row[<span class="dv">6</span>:]</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  index <span class="op">=</span> np.where(genre_int<span class="op">==</span><span class="dv">1</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># return genres[index[0]]</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="st">' '</span>.join(genres[index[<span class="dv">0</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-outputid="9952bdc6-1d41-4675-f69e-09da130f9c9e" data-execution_count="6">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>movies[<span class="st">'Genre'</span>] <span class="op">=</span> movies.<span class="bu">apply</span>(create_genre, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>movies</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">

  <div id="df-2c06aaff-e45d-484f-9ead-b38c39d81d8e" class="colab-df-container">
    <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">movie id</th>
<th data-quarto-table-cell-role="th">movie title</th>
<th data-quarto-table-cell-role="th">release date</th>
<th data-quarto-table-cell-role="th">video release date</th>
<th data-quarto-table-cell-role="th">IMDb URL</th>
<th data-quarto-table-cell-role="th">unknown</th>
<th data-quarto-table-cell-role="th">Action</th>
<th data-quarto-table-cell-role="th">Adventure</th>
<th data-quarto-table-cell-role="th">Animation</th>
<th data-quarto-table-cell-role="th">Children's</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">Film-Noir</th>
<th data-quarto-table-cell-role="th">Horror</th>
<th data-quarto-table-cell-role="th">Musical</th>
<th data-quarto-table-cell-role="th">Mystery</th>
<th data-quarto-table-cell-role="th">Romance</th>
<th data-quarto-table-cell-role="th">Sci-Fi</th>
<th data-quarto-table-cell-role="th">Thriller</th>
<th data-quarto-table-cell-role="th">War</th>
<th data-quarto-table-cell-role="th">Western</th>
<th data-quarto-table-cell-role="th">Genre</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>Toy Story (1995)</td>
<td>01-Jan-1995</td>
<td>NaN</td>
<td>http://us.imdb.com/M/title-exact?Toy%20Story%2...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>Animation Children's Comedy</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2</td>
<td>GoldenEye (1995)</td>
<td>01-Jan-1995</td>
<td>NaN</td>
<td>http://us.imdb.com/M/title-exact?GoldenEye%20(...</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>Action Adventure Thriller</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3</td>
<td>Four Rooms (1995)</td>
<td>01-Jan-1995</td>
<td>NaN</td>
<td>http://us.imdb.com/M/title-exact?Four%20Rooms%...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>Thriller</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4</td>
<td>Get Shorty (1995)</td>
<td>01-Jan-1995</td>
<td>NaN</td>
<td>http://us.imdb.com/M/title-exact?Get%20Shorty%...</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>Action Comedy Drama</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5</td>
<td>Copycat (1995)</td>
<td>01-Jan-1995</td>
<td>NaN</td>
<td>http://us.imdb.com/M/title-exact?Copycat%20(1995)</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>Crime Drama Thriller</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1677</td>
<td>1678</td>
<td>Mat' i syn (1997)</td>
<td>06-Feb-1998</td>
<td>NaN</td>
<td>http://us.imdb.com/M/title-exact?Mat%27+i+syn+...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>Drama</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1678</td>
<td>1679</td>
<td>B. Monkey (1998)</td>
<td>06-Feb-1998</td>
<td>NaN</td>
<td>http://us.imdb.com/M/title-exact?B%2E+Monkey+(...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>Romance Thriller</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1679</td>
<td>1680</td>
<td>Sliding Doors (1998)</td>
<td>01-Jan-1998</td>
<td>NaN</td>
<td>http://us.imdb.com/Title?Sliding+Doors+(1998)</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>Drama Romance</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1680</td>
<td>1681</td>
<td>You So Crazy (1994)</td>
<td>01-Jan-1994</td>
<td>NaN</td>
<td>http://us.imdb.com/M/title-exact?You%20So%20Cr...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>Comedy</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1681</td>
<td>1682</td>
<td>Scream of Stone (Schrei aus Stein) (1991)</td>
<td>08-Mar-1996</td>
<td>NaN</td>
<td>http://us.imdb.com/M/title-exact?Schrei%20aus%...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>Drama</td>
</tr>
</tbody>
</table>


<p>1682 rows × 25 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-2c06aaff-e45d-484f-9ead-b38c39d81d8e')" title="Convert this dataframe to an interactive table." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-2c06aaff-e45d-484f-9ead-b38c39d81d8e button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-2c06aaff-e45d-484f-9ead-b38c39d81d8e');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-27bcc806-2ee5-4f0c-b6f3-420360353e6f">
  <button class="colab-df-quickchart" onclick="quickchart('df-27bcc806-2ee5-4f0c-b6f3-420360353e6f')" title="Suggest charts." style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"></path>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-27bcc806-2ee5-4f0c-b6f3-420360353e6f button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div>
</div>
<div class="cell" data-outputid="6788dec1-3ce5-405f-fdb5-7c82b20cf222" data-execution_count="7">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>users <span class="op">=</span> pd.read_csv(<span class="st">'./ml-100k/u.user'</span>, sep<span class="op">=</span><span class="st">'|'</span>, encoding<span class="op">=</span><span class="st">'latin-1'</span>, names <span class="op">=</span> [<span class="st">'user id'</span> , <span class="st">'age'</span> , <span class="st">'gender'</span> , <span class="st">'occupation'</span> , <span class="st">'zip code'</span>])</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>users</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">

  <div id="df-9685375d-9dcc-4f73-84b8-b9272fe1c3d2" class="colab-df-container">
    <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">user id</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">gender</th>
<th data-quarto-table-cell-role="th">occupation</th>
<th data-quarto-table-cell-role="th">zip code</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>24</td>
<td>M</td>
<td>technician</td>
<td>85711</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2</td>
<td>53</td>
<td>F</td>
<td>other</td>
<td>94043</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3</td>
<td>23</td>
<td>M</td>
<td>writer</td>
<td>32067</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4</td>
<td>24</td>
<td>M</td>
<td>technician</td>
<td>43537</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5</td>
<td>33</td>
<td>F</td>
<td>other</td>
<td>15213</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">938</td>
<td>939</td>
<td>26</td>
<td>F</td>
<td>student</td>
<td>33319</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">939</td>
<td>940</td>
<td>32</td>
<td>M</td>
<td>administrator</td>
<td>02215</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">940</td>
<td>941</td>
<td>20</td>
<td>M</td>
<td>student</td>
<td>97229</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">941</td>
<td>942</td>
<td>48</td>
<td>F</td>
<td>librarian</td>
<td>78209</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">942</td>
<td>943</td>
<td>22</td>
<td>M</td>
<td>student</td>
<td>77841</td>
</tr>
</tbody>
</table>


<p>943 rows × 5 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-9685375d-9dcc-4f73-84b8-b9272fe1c3d2')" title="Convert this dataframe to an interactive table." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-9685375d-9dcc-4f73-84b8-b9272fe1c3d2 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-9685375d-9dcc-4f73-84b8-b9272fe1c3d2');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-b7716645-799d-4d41-9318-98b98d12aa5e">
  <button class="colab-df-quickchart" onclick="quickchart('df-b7716645-799d-4d41-9318-98b98d12aa5e')" title="Suggest charts." style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"></path>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-b7716645-799d-4d41-9318-98b98d12aa5e button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div>
</div>
<div class="cell" data-outputid="81b2ff12-6909-45d8-ba3d-895ba83ff30b" data-execution_count="8">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>ratings <span class="op">=</span> pd.read_csv(<span class="st">'./ml-100k/u.data'</span>, sep<span class="op">=</span><span class="st">'</span><span class="ch">\t</span><span class="st">'</span>, names <span class="op">=</span> [<span class="st">'uid'</span>, <span class="st">'mid'</span>, <span class="st">'rating'</span>, <span class="st">'timestamp'</span>])</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>ratings</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">

  <div id="df-5c2c9726-9447-49fd-bdcc-1c6ba7cf847e" class="colab-df-container">
    <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">uid</th>
<th data-quarto-table-cell-role="th">mid</th>
<th data-quarto-table-cell-role="th">rating</th>
<th data-quarto-table-cell-role="th">timestamp</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>196</td>
<td>242</td>
<td>3</td>
<td>881250949</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>186</td>
<td>302</td>
<td>3</td>
<td>891717742</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>22</td>
<td>377</td>
<td>1</td>
<td>878887116</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>244</td>
<td>51</td>
<td>2</td>
<td>880606923</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>166</td>
<td>346</td>
<td>1</td>
<td>886397596</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">99995</td>
<td>880</td>
<td>476</td>
<td>3</td>
<td>880175444</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">99996</td>
<td>716</td>
<td>204</td>
<td>5</td>
<td>879795543</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">99997</td>
<td>276</td>
<td>1090</td>
<td>1</td>
<td>874795795</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">99998</td>
<td>13</td>
<td>225</td>
<td>2</td>
<td>882399156</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">99999</td>
<td>12</td>
<td>203</td>
<td>3</td>
<td>879959583</td>
</tr>
</tbody>
</table>


<p>100000 rows × 4 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-5c2c9726-9447-49fd-bdcc-1c6ba7cf847e')" title="Convert this dataframe to an interactive table." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-5c2c9726-9447-49fd-bdcc-1c6ba7cf847e button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-5c2c9726-9447-49fd-bdcc-1c6ba7cf847e');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-06c8709b-6ccd-40ac-bdac-584914e160ba">
  <button class="colab-df-quickchart" onclick="quickchart('df-06c8709b-6ccd-40ac-bdac-584914e160ba')" title="Suggest charts." style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"></path>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-06c8709b-6ccd-40ac-bdac-584914e160ba button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div>
</div>
<div class="cell" data-outputid="30c7ef6a-5cbf-4e0a-9fa3-28f8a0851c88" data-execution_count="9">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>ratings.rating.value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>4    34174
3    27145
5    21201
2    11370
1     6110
Name: rating, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-outputid="a81af0ef-fa13-42c7-ce42-b235a18db695" data-execution_count="10">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>a_pivot <span class="op">=</span> pd.pivot_table(ratings, values <span class="op">=</span> <span class="st">'rating'</span>, columns <span class="op">=</span> <span class="st">'mid'</span>, index <span class="op">=</span> <span class="st">'uid'</span>, fill_value <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>a_pivot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">

  <div id="df-68b1fd52-0a4d-40cf-80d6-daf7318094af" class="colab-df-container">
    <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">mid</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">3</th>
<th data-quarto-table-cell-role="th">4</th>
<th data-quarto-table-cell-role="th">5</th>
<th data-quarto-table-cell-role="th">6</th>
<th data-quarto-table-cell-role="th">7</th>
<th data-quarto-table-cell-role="th">8</th>
<th data-quarto-table-cell-role="th">9</th>
<th data-quarto-table-cell-role="th">10</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">1673</th>
<th data-quarto-table-cell-role="th">1674</th>
<th data-quarto-table-cell-role="th">1675</th>
<th data-quarto-table-cell-role="th">1676</th>
<th data-quarto-table-cell-role="th">1677</th>
<th data-quarto-table-cell-role="th">1678</th>
<th data-quarto-table-cell-role="th">1679</th>
<th data-quarto-table-cell-role="th">1680</th>
<th data-quarto-table-cell-role="th">1681</th>
<th data-quarto-table-cell-role="th">1682</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">uid</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>5</td>
<td>3</td>
<td>4</td>
<td>3</td>
<td>3</td>
<td>5</td>
<td>4</td>
<td>1</td>
<td>5</td>
<td>3</td>
<td>...</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>4</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>2</td>
<td>...</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>...</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>...</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>4</td>
<td>3</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>...</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">939</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>5</td>
<td>-1</td>
<td>...</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">940</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>2</td>
<td>-1</td>
<td>-1</td>
<td>4</td>
<td>5</td>
<td>3</td>
<td>-1</td>
<td>...</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">941</td>
<td>5</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>4</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>...</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">942</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>...</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">943</td>
<td>-1</td>
<td>5</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>3</td>
<td>-1</td>
<td>...</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
<td>-1</td>
</tr>
</tbody>
</table>


<p>943 rows × 1682 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-68b1fd52-0a4d-40cf-80d6-daf7318094af')" title="Convert this dataframe to an interactive table." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-68b1fd52-0a4d-40cf-80d6-daf7318094af button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-68b1fd52-0a4d-40cf-80d6-daf7318094af');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-14a42396-eb91-4c06-8038-5c726253a099">
  <button class="colab-df-quickchart" onclick="quickchart('df-14a42396-eb91-4c06-8038-5c726253a099')" title="Suggest charts." style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"></path>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-14a42396-eb91-4c06-8038-5c726253a099 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div>
</div>
<div class="cell" data-outputid="2161c8d7-1fc4-4b41-a8ec-a318fe405410" data-execution_count="11">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> a_pivot.to_numpy()</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> torch.tensor(a).<span class="bu">float</span>()</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>tensor([[ 5.,  3.,  4.,  ..., -1., -1., -1.],
        [ 4., -1., -1.,  ..., -1., -1., -1.],
        [-1., -1., -1.,  ..., -1., -1., -1.],
        ...,
        [ 5., -1., -1.,  ..., -1., -1., -1.],
        [-1., -1., -1.,  ..., -1., -1., -1.],
        [-1.,  5., -1.,  ..., -1., -1., -1.]])</code></pre>
</div>
</div>
<div class="cell" data-outputid="59ce2bb2-7921-4af0-d002-c7425570ae15" data-execution_count="12">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>a.numel()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>1586126</code></pre>
</div>
</div>
<div class="cell" data-outputid="f3941869-37a4-47f3-e885-af3006651ac7" data-execution_count="13">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>(a<span class="op">==</span>(<span class="op">-</span><span class="dv">1</span>)).<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>tensor(1486126)</code></pre>
</div>
</div>
<div class="cell" data-outputid="e5487f81-2dab-4828-cdbd-0cbdd7d37ae2" data-execution_count="14">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>a.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>torch.Size([943, 1682])</code></pre>
</div>
</div>
<div class="cell" data-outputid="c34ba608-0e99-4e4b-bf09-269879487736" data-execution_count="15">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>k <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>u <span class="op">=</span> torch.randn(a.shape[<span class="dv">0</span>], k, requires_grad<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>v <span class="op">=</span> torch.randn(k, a.shape[<span class="dv">1</span>],  requires_grad<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>u.shape, v.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>(torch.Size([943, 20]), torch.Size([20, 1682]))</code></pre>
</div>
</div>
<div class="cell" data-outputid="d888199f-8c93-43af-8242-286f7745e6de" data-execution_count="16">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>optim <span class="op">=</span> torch.optim.SGD([u, v], lr <span class="op">=</span> <span class="fl">0.5</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>loss_fn <span class="op">=</span> torch.nn.MSELoss()</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>epoch <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>mask <span class="op">=</span> a <span class="op">&gt;=</span> <span class="dv">0</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ep <span class="kw">in</span> <span class="bu">range</span>(epoch):</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  a_hat <span class="op">=</span> u <span class="op">@</span> v</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  loss <span class="op">=</span> loss_fn(a_hat[mask], a[mask])</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  loss.backward()</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  optim.step()</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  optim.zero_grad()</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> ep<span class="op">%</span><span class="dv">100</span><span class="op">==</span><span class="dv">0</span>:</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f'epoch </span><span class="sc">{</span>ep<span class="sc">}</span><span class="ss">: rmse loss </span><span class="sc">{</span>loss<span class="sc">.</span>detach()<span class="sc">.</span>sqrt()<span class="sc">.</span>item()<span class="sc">:0.4f}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>epoch 0: rmse loss 5.8354
epoch 100: rmse loss 4.8373
epoch 200: rmse loss 4.3531
epoch 300: rmse loss 4.0140
epoch 400: rmse loss 3.6677
epoch 500: rmse loss 3.2592
epoch 600: rmse loss 2.8526
epoch 700: rmse loss 2.5214
epoch 800: rmse loss 2.2663
epoch 900: rmse loss 2.0665</code></pre>
</div>
</div>
<section id="activesgd" class="level2">
<h2 class="anchored" data-anchor-id="activesgd">activeSGD</h2>
<div class="cell" data-outputid="86d44149-30c6-4a80-d474-f072ec31c5fc" data-execution_count="17">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>wget https:<span class="op">//</span>raw.githubusercontent.com<span class="op">/</span>davoodwadi<span class="op">/</span>active<span class="op">-</span>lr<span class="op">/</span>main<span class="op">/</span>optimizers<span class="op">/</span>ActiveSGD.py</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>--2023-09-25 12:23:21--  https://raw.githubusercontent.com/davoodwadi/active-lr/main/optimizers/ActiveSGD.py
Resolving raw.githubusercontent.com (raw.githubusercontent.com)... 185.199.108.133, 185.199.109.133, 185.199.110.133, ...
Connecting to raw.githubusercontent.com (raw.githubusercontent.com)|185.199.108.133|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 4148 (4.1K) [text/plain]
Saving to: ‘ActiveSGD.py’

ActiveSGD.py          0%[                    ]       0  --.-KB/s               ActiveSGD.py        100%[===================&gt;]   4.05K  --.-KB/s    in 0s      

2023-09-25 12:23:21 (43.4 MB/s) - ‘ActiveSGD.py’ saved [4148/4148]
</code></pre>
</div>
</div>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> ActiveSGD <span class="im">import</span> ActiveSGD</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-outputid="2bfafee1-8b3d-4b59-f4f4-f954eda1f3cc" data-execution_count="19">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>k <span class="op">=</span> <span class="dv">200</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>u <span class="op">=</span> torch.randn(a.shape[<span class="dv">0</span>], k, requires_grad<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>v <span class="op">=</span> torch.randn(k, a.shape[<span class="dv">1</span>],  requires_grad<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>u.shape, v.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>(torch.Size([943, 200]), torch.Size([200, 1682]))</code></pre>
</div>
</div>
<div class="cell" data-outputid="0f689060-b402-4596-ffe1-5479bad71f4f" data-execution_count="20">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>stepSize <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>optim <span class="op">=</span> ActiveSGD([u, v], stepSize<span class="op">=</span>stepSize, lr <span class="op">=</span> <span class="fl">0.5</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>loss_fn <span class="op">=</span> torch.nn.MSELoss()</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>epoch <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>mask <span class="op">=</span> a <span class="op">&gt;=</span> <span class="dv">0</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ep <span class="kw">in</span> <span class="bu">range</span>(epoch):</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  a_hat <span class="op">=</span> u <span class="op">@</span> v</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  loss <span class="op">=</span> loss_fn(a_hat[mask], a[mask])</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  loss.backward()</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  optim.step()</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  optim.zero_grad()</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> ep<span class="op">%</span><span class="dv">100</span><span class="op">==</span><span class="dv">0</span>:</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f'epoch </span><span class="sc">{</span>ep<span class="sc">}</span><span class="ss">: rmse loss </span><span class="sc">{</span>loss<span class="sc">.</span>detach()<span class="sc">.</span>sqrt()<span class="sc">.</span>item()<span class="sc">:0.4f}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>epoch 0: rmse loss 14.6202
epoch 100: rmse loss 0.3853
epoch 200: rmse loss 0.1878
epoch 300: rmse loss 0.1045
epoch 400: rmse loss 0.0629
epoch 500: rmse loss 0.0414
epoch 600: rmse loss 0.0290
epoch 700: rmse loss 0.0211
epoch 800: rmse loss 0.0159
epoch 900: rmse loss 0.0123</code></pre>
</div>
</div>
<div class="cell" data-outputid="066689f9-636e-4d1a-878c-f8ca2f24e3e0" data-execution_count="21">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> torch.no_grad():</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  a_hat <span class="op">=</span> u <span class="op">@</span> v</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>a_hat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>tensor([[ 5.0043e+00,  2.9998e+00,  4.0002e+00,  ..., -2.2038e+00,
          4.1306e-03,  6.7976e+00],
        [ 3.9989e+00,  4.1398e+00, -7.4116e-02,  ..., -5.7194e+00,
          9.1199e+00, -1.6044e+01],
        [ 4.5649e+00, -1.6729e+01, -3.5799e+00,  ...,  1.4431e+01,
         -2.1896e-01, -9.5088e+00],
        ...,
        [ 4.9977e+00, -9.2435e-01,  2.1641e+01,  ..., -1.7008e+01,
          8.9838e+00, -1.4964e+01],
        [ 4.7857e+00, -6.4135e+00,  5.1219e+00,  ...,  1.3930e+00,
         -3.8581e+00, -1.4237e+01],
        [ 6.6980e+00,  5.0004e+00,  5.6941e+00,  ...,  1.2654e+01,
          1.2119e+01,  1.2553e+01]])</code></pre>
</div>
</div>
</section>
<section id="get-recommendations" class="level1">
<h1>Get recommendations</h1>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> watched(uid):</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  watched <span class="op">=</span> ratings[ratings.uid<span class="op">==</span>uid]</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  ret <span class="op">=</span> watched.mid.to_numpy()</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  ret <span class="op">=</span> movies[movies[<span class="st">'movie id'</span>].isin(ret)][<span class="st">'movie title'</span>]</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> ret</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> watched_liked(uid, threshold<span class="op">=</span><span class="fl">3.5</span>):</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  watched <span class="op">=</span> ratings[(ratings.uid<span class="op">==</span>uid) <span class="op">&amp;</span> (ratings.rating<span class="op">&gt;</span>threshold)]</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  ret <span class="op">=</span> watched.mid.to_numpy()</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  ret <span class="op">=</span> movies[movies[<span class="st">'movie id'</span>].isin(ret)][<span class="st">'movie title'</span>]</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> ret</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> not_watched(uid):</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>  watched <span class="op">=</span> ratings[(ratings.uid<span class="op">==</span>uid)]</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>  ret <span class="op">=</span> watched.mid.to_numpy()</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>  ret <span class="op">=</span> movies[<span class="op">~</span>movies[<span class="st">'movie id'</span>].isin(ret)][<span class="st">'movie title'</span>]</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> ret</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>uid <span class="op">=</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-outputid="67d0679b-5e40-4f2c-e5db-ea77aafb0319" data-execution_count="24">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>watched_liked(uid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>0                                       Toy Story (1995)
2                                      Four Rooms (1995)
5      Shanghai Triad (Yao a yao yao dao waipo qiao) ...
6                                  Twelve Monkeys (1995)
8                                Dead Man Walking (1995)
                             ...                        
264                     Hunt for Red October, The (1990)
266                                              unknown
267                                   Chasing Amy (1997)
268                               Full Monty, The (1997)
269                                       Gattaca (1997)
Name: movie title, Length: 163, dtype: object</code></pre>
</div>
</div>
<div class="cell" data-outputid="d5c76431-3174-4f78-d2e7-f6a22692dd48" data-execution_count="25">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>watched(uid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>0              Toy Story (1995)
1              GoldenEye (1995)
2             Four Rooms (1995)
3             Get Shorty (1995)
4                Copycat (1995)
                 ...           
267          Chasing Amy (1997)
268      Full Monty, The (1997)
269              Gattaca (1997)
270    Starship Troopers (1997)
271    Good Will Hunting (1997)
Name: movie title, Length: 272, dtype: object</code></pre>
</div>
</div>
<div class="cell" data-outputid="00ae033e-fdc7-4dbd-e666-3a0591c979c2" data-execution_count="26">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>nw <span class="op">=</span> not_watched(uid)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>nw</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>272                                   Heat (1995)
273                                Sabrina (1995)
274                  Sense and Sensibility (1995)
275                      Leaving Las Vegas (1995)
276                            Restoration (1995)
                          ...                    
1677                            Mat' i syn (1997)
1678                             B. Monkey (1998)
1679                         Sliding Doors (1998)
1680                          You So Crazy (1994)
1681    Scream of Stone (Schrei aus Stein) (1991)
Name: movie title, Length: 1410, dtype: object</code></pre>
</div>
</div>
<div class="cell" data-outputid="d7de46a4-cfa1-4ed2-a445-9263454ee91a" data-execution_count="27">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>nw.index.to_numpy()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>array([ 272,  273,  274, ..., 1679, 1680, 1681])</code></pre>
</div>
</div>
<div class="cell" data-outputid="f3a7ebcb-8934-4512-f32f-43c0d2dc59e1" data-execution_count="28">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>prediction_df <span class="op">=</span> pd.DataFrame(a_hat, index<span class="op">=</span><span class="bu">range</span>(<span class="dv">1</span>, a_hat.shape[<span class="dv">0</span>]<span class="op">+</span><span class="dv">1</span>), columns<span class="op">=</span><span class="bu">range</span>(<span class="dv">1</span>, a_hat.shape[<span class="dv">1</span>]<span class="op">+</span><span class="dv">1</span>))</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>prediction_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">

  <div id="df-c3080de1-cf86-4477-866b-901daa38b01b" class="colab-df-container">
    <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">3</th>
<th data-quarto-table-cell-role="th">4</th>
<th data-quarto-table-cell-role="th">5</th>
<th data-quarto-table-cell-role="th">6</th>
<th data-quarto-table-cell-role="th">7</th>
<th data-quarto-table-cell-role="th">8</th>
<th data-quarto-table-cell-role="th">9</th>
<th data-quarto-table-cell-role="th">10</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">1673</th>
<th data-quarto-table-cell-role="th">1674</th>
<th data-quarto-table-cell-role="th">1675</th>
<th data-quarto-table-cell-role="th">1676</th>
<th data-quarto-table-cell-role="th">1677</th>
<th data-quarto-table-cell-role="th">1678</th>
<th data-quarto-table-cell-role="th">1679</th>
<th data-quarto-table-cell-role="th">1680</th>
<th data-quarto-table-cell-role="th">1681</th>
<th data-quarto-table-cell-role="th">1682</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>5.004304</td>
<td>2.999811</td>
<td>4.000242</td>
<td>3.000716</td>
<td>3.000912</td>
<td>4.999877</td>
<td>4.000716</td>
<td>0.998199</td>
<td>4.999877</td>
<td>2.999701</td>
<td>...</td>
<td>2.677487</td>
<td>8.868751</td>
<td>-2.484020</td>
<td>7.437770</td>
<td>1.646107</td>
<td>-2.040292</td>
<td>2.632884</td>
<td>-2.203806</td>
<td>0.004131</td>
<td>6.797606</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>3.998886</td>
<td>4.139823</td>
<td>-0.074116</td>
<td>5.091535</td>
<td>-3.209011</td>
<td>0.062505</td>
<td>9.377804</td>
<td>12.178069</td>
<td>7.282120</td>
<td>2.000203</td>
<td>...</td>
<td>-2.581928</td>
<td>0.724032</td>
<td>-15.948099</td>
<td>-11.589712</td>
<td>6.701364</td>
<td>-9.218519</td>
<td>24.118979</td>
<td>-5.719369</td>
<td>9.119939</td>
<td>-16.043646</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>4.564934</td>
<td>-16.729370</td>
<td>-3.579922</td>
<td>4.843268</td>
<td>14.048830</td>
<td>-0.669037</td>
<td>3.204421</td>
<td>-12.504386</td>
<td>6.343798</td>
<td>9.640670</td>
<td>...</td>
<td>3.225056</td>
<td>-15.500827</td>
<td>13.296917</td>
<td>4.111541</td>
<td>3.764230</td>
<td>-3.893084</td>
<td>6.357164</td>
<td>14.431271</td>
<td>-0.218964</td>
<td>-9.508836</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>7.609192</td>
<td>10.523496</td>
<td>-2.323120</td>
<td>-1.952215</td>
<td>7.184854</td>
<td>-18.966362</td>
<td>-0.841128</td>
<td>9.049640</td>
<td>-5.000579</td>
<td>9.116615</td>
<td>...</td>
<td>20.477491</td>
<td>-5.735116</td>
<td>13.504451</td>
<td>1.787438</td>
<td>-16.389277</td>
<td>17.946774</td>
<td>-15.046497</td>
<td>7.390345</td>
<td>-11.824745</td>
<td>-0.435370</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>3.996701</td>
<td>3.000138</td>
<td>-6.053336</td>
<td>9.426641</td>
<td>8.825453</td>
<td>-0.675734</td>
<td>2.194716</td>
<td>2.264828</td>
<td>7.741161</td>
<td>-3.040463</td>
<td>...</td>
<td>1.181675</td>
<td>-9.759852</td>
<td>-5.752519</td>
<td>-7.259325</td>
<td>6.817764</td>
<td>4.865910</td>
<td>8.720139</td>
<td>-1.766573</td>
<td>11.869007</td>
<td>-10.755214</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">939</td>
<td>-0.201188</td>
<td>12.854153</td>
<td>12.797200</td>
<td>5.344156</td>
<td>-2.537490</td>
<td>-18.122219</td>
<td>4.691484</td>
<td>-2.372149</td>
<td>5.000305</td>
<td>3.658480</td>
<td>...</td>
<td>13.305645</td>
<td>-8.472819</td>
<td>25.497574</td>
<td>-0.093947</td>
<td>-16.408646</td>
<td>4.364131</td>
<td>1.032204</td>
<td>24.839842</td>
<td>-24.223797</td>
<td>-2.213850</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">940</td>
<td>1.058385</td>
<td>0.455055</td>
<td>1.329990</td>
<td>1.999800</td>
<td>5.846478</td>
<td>-5.103072</td>
<td>3.997473</td>
<td>5.000207</td>
<td>3.000424</td>
<td>-14.281948</td>
<td>...</td>
<td>23.090666</td>
<td>-7.207386</td>
<td>-2.602040</td>
<td>1.720446</td>
<td>-6.536170</td>
<td>13.851688</td>
<td>32.706913</td>
<td>-3.953150</td>
<td>5.664157</td>
<td>-3.137197</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">941</td>
<td>4.997713</td>
<td>-0.924346</td>
<td>21.641083</td>
<td>9.770977</td>
<td>-7.051800</td>
<td>3.512075</td>
<td>3.999628</td>
<td>6.511045</td>
<td>4.752253</td>
<td>2.856754</td>
<td>...</td>
<td>-11.042938</td>
<td>-2.952090</td>
<td>-2.219363</td>
<td>3.364909</td>
<td>8.664539</td>
<td>6.179554</td>
<td>-2.757024</td>
<td>-17.007853</td>
<td>8.983795</td>
<td>-14.963533</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">942</td>
<td>4.785673</td>
<td>-6.413533</td>
<td>5.121909</td>
<td>1.225757</td>
<td>-5.503317</td>
<td>5.218601</td>
<td>1.684648</td>
<td>1.952597</td>
<td>0.761365</td>
<td>-6.901558</td>
<td>...</td>
<td>-16.204861</td>
<td>12.844807</td>
<td>6.803994</td>
<td>27.892262</td>
<td>3.549176</td>
<td>7.932891</td>
<td>-9.075477</td>
<td>1.393004</td>
<td>-3.858129</td>
<td>-14.237255</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">943</td>
<td>6.697975</td>
<td>5.000370</td>
<td>5.694087</td>
<td>-0.982359</td>
<td>13.534009</td>
<td>-0.004046</td>
<td>6.311112</td>
<td>-0.534626</td>
<td>3.000633</td>
<td>2.858477</td>
<td>...</td>
<td>3.123006</td>
<td>18.806067</td>
<td>0.855726</td>
<td>-9.229968</td>
<td>7.491789</td>
<td>-5.800776</td>
<td>-3.862041</td>
<td>12.653639</td>
<td>12.118929</td>
<td>12.552554</td>
</tr>
</tbody>
</table>


<p>943 rows × 1682 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-c3080de1-cf86-4477-866b-901daa38b01b')" title="Convert this dataframe to an interactive table." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-c3080de1-cf86-4477-866b-901daa38b01b button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-c3080de1-cf86-4477-866b-901daa38b01b');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-787ddbd5-0692-45f8-8daa-937d8674e5eb">
  <button class="colab-df-quickchart" onclick="quickchart('df-787ddbd5-0692-45f8-8daa-937d8674e5eb')" title="Suggest charts." style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"></path>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-787ddbd5-0692-45f8-8daa-937d8674e5eb button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div>
</div>
<div class="cell" data-outputid="b8e61688-521c-41a3-ba92-34d167863278" data-execution_count="29">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>predicted <span class="op">=</span> pd.merge(movies[[<span class="st">'movie id'</span>, <span class="st">'movie title'</span>, <span class="st">'Genre'</span>]], ratings[ratings.uid<span class="op">==</span>uid][[<span class="st">'mid'</span>, <span class="st">'rating'</span>]], left_on<span class="op">=</span><span class="st">'movie id'</span>, right_on<span class="op">=</span><span class="st">'mid'</span>, how<span class="op">=</span><span class="st">'left'</span>).drop(<span class="st">'mid'</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>predicted <span class="op">=</span> predicted.set_index(<span class="st">'movie id'</span>)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>predicted[<span class="st">'predicted_rating'</span>] <span class="op">=</span> prediction_df.loc[uid] <span class="co"># choose the user</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>predicted[<span class="st">'rating_count'</span>] <span class="op">=</span> ratings.groupby(<span class="st">'mid'</span>).count()[<span class="st">'rating'</span>] <span class="co"># set the number of ratings as measure for popularity</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>predicted</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">

  <div id="df-9e880b54-7d8b-4d03-a4e5-e979a9fee064" class="colab-df-container">
    <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">movie title</th>
<th data-quarto-table-cell-role="th">Genre</th>
<th data-quarto-table-cell-role="th">rating</th>
<th data-quarto-table-cell-role="th">predicted_rating</th>
<th data-quarto-table-cell-role="th">rating_count</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">movie id</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>Toy Story (1995)</td>
<td>Animation Children's Comedy</td>
<td>5.0</td>
<td>5.004304</td>
<td>452</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>GoldenEye (1995)</td>
<td>Action Adventure Thriller</td>
<td>3.0</td>
<td>2.999811</td>
<td>131</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>Four Rooms (1995)</td>
<td>Thriller</td>
<td>4.0</td>
<td>4.000242</td>
<td>90</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>Get Shorty (1995)</td>
<td>Action Comedy Drama</td>
<td>3.0</td>
<td>3.000716</td>
<td>209</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>Copycat (1995)</td>
<td>Crime Drama Thriller</td>
<td>3.0</td>
<td>3.000912</td>
<td>86</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1678</td>
<td>Mat' i syn (1997)</td>
<td>Drama</td>
<td>NaN</td>
<td>-2.040292</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1679</td>
<td>B. Monkey (1998)</td>
<td>Romance Thriller</td>
<td>NaN</td>
<td>2.632884</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1680</td>
<td>Sliding Doors (1998)</td>
<td>Drama Romance</td>
<td>NaN</td>
<td>-2.203806</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1681</td>
<td>You So Crazy (1994)</td>
<td>Comedy</td>
<td>NaN</td>
<td>0.004131</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1682</td>
<td>Scream of Stone (Schrei aus Stein) (1991)</td>
<td>Drama</td>
<td>NaN</td>
<td>6.797606</td>
<td>1</td>
</tr>
</tbody>
</table>


<p>1682 rows × 5 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-9e880b54-7d8b-4d03-a4e5-e979a9fee064')" title="Convert this dataframe to an interactive table." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-9e880b54-7d8b-4d03-a4e5-e979a9fee064 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-9e880b54-7d8b-4d03-a4e5-e979a9fee064');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-704107ea-72bc-4f58-b6db-ad14c5be5094">
  <button class="colab-df-quickchart" onclick="quickchart('df-704107ea-72bc-4f58-b6db-ad14c5be5094')" title="Suggest charts." style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"></path>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-704107ea-72bc-4f58-b6db-ad14c5be5094 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div>
</div>
<div class="cell" data-outputid="56ee1a09-b90c-4960-ba66-1d511b0d5f99" data-execution_count="30">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>min_rev <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>popular_movies <span class="op">=</span> predicted[predicted.rating_count<span class="op">&gt;</span>min_rev]</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>popular_movies</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">

  <div id="df-37ac10f3-89d2-41e3-9594-bfca74cd0b3d" class="colab-df-container">
    <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">movie title</th>
<th data-quarto-table-cell-role="th">Genre</th>
<th data-quarto-table-cell-role="th">rating</th>
<th data-quarto-table-cell-role="th">predicted_rating</th>
<th data-quarto-table-cell-role="th">rating_count</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">movie id</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>Toy Story (1995)</td>
<td>Animation Children's Comedy</td>
<td>5.0</td>
<td>5.004304</td>
<td>452</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>GoldenEye (1995)</td>
<td>Action Adventure Thriller</td>
<td>3.0</td>
<td>2.999811</td>
<td>131</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Get Shorty (1995)</td>
<td>Action Comedy Drama</td>
<td>3.0</td>
<td>3.000716</td>
<td>209</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>Twelve Monkeys (1995)</td>
<td>Drama Sci-Fi</td>
<td>4.0</td>
<td>4.000716</td>
<td>392</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>Babe (1995)</td>
<td>Children's Comedy Drama</td>
<td>1.0</td>
<td>0.998199</td>
<td>219</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">926</td>
<td>Down Periscope (1996)</td>
<td>Comedy</td>
<td>NaN</td>
<td>7.610969</td>
<td>101</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">928</td>
<td>Craft, The (1996)</td>
<td>Drama Horror</td>
<td>NaN</td>
<td>0.913853</td>
<td>104</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1016</td>
<td>Con Air (1997)</td>
<td>Action Adventure Thriller</td>
<td>NaN</td>
<td>9.294837</td>
<td>137</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1028</td>
<td>Grumpier Old Men (1995)</td>
<td>Comedy Romance</td>
<td>NaN</td>
<td>6.704905</td>
<td>148</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1047</td>
<td>Multiplicity (1996)</td>
<td>Comedy</td>
<td>NaN</td>
<td>17.834051</td>
<td>134</td>
</tr>
</tbody>
</table>


<p>334 rows × 5 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-37ac10f3-89d2-41e3-9594-bfca74cd0b3d')" title="Convert this dataframe to an interactive table." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-37ac10f3-89d2-41e3-9594-bfca74cd0b3d button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-37ac10f3-89d2-41e3-9594-bfca74cd0b3d');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-edc8749f-ceae-479e-93b7-a6372c83f164">
  <button class="colab-df-quickchart" onclick="quickchart('df-edc8749f-ceae-479e-93b7-a6372c83f164')" title="Suggest charts." style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"></path>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-edc8749f-ceae-479e-93b7-a6372c83f164 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div>
</div>
<div class="cell" data-outputid="ca4bb283-fd4a-46a1-c4d6-b3057c71b23d" data-execution_count="31">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>popular_movies_like <span class="op">=</span> popular_movies[popular_movies.predicted_rating<span class="op">&gt;=</span><span class="dv">4</span>]</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>popular_movies_like</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">

  <div id="df-986f08c1-5fb2-4473-9762-3f86f493375d" class="colab-df-container">
    <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">movie title</th>
<th data-quarto-table-cell-role="th">Genre</th>
<th data-quarto-table-cell-role="th">rating</th>
<th data-quarto-table-cell-role="th">predicted_rating</th>
<th data-quarto-table-cell-role="th">rating_count</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">movie id</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>Toy Story (1995)</td>
<td>Animation Children's Comedy</td>
<td>5.0</td>
<td>5.004304</td>
<td>452</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>Twelve Monkeys (1995)</td>
<td>Drama Sci-Fi</td>
<td>4.0</td>
<td>4.000716</td>
<td>392</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9</td>
<td>Dead Man Walking (1995)</td>
<td>Drama</td>
<td>5.0</td>
<td>4.999877</td>
<td>299</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12</td>
<td>Usual Suspects, The (1995)</td>
<td>Crime Thriller</td>
<td>5.0</td>
<td>5.000423</td>
<td>267</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">13</td>
<td>Mighty Aphrodite (1995)</td>
<td>Comedy</td>
<td>5.0</td>
<td>4.999995</td>
<td>184</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">895</td>
<td>Scream 2 (1997)</td>
<td>Horror Thriller</td>
<td>NaN</td>
<td>4.546927</td>
<td>106</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">926</td>
<td>Down Periscope (1996)</td>
<td>Comedy</td>
<td>NaN</td>
<td>7.610969</td>
<td>101</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1016</td>
<td>Con Air (1997)</td>
<td>Action Adventure Thriller</td>
<td>NaN</td>
<td>9.294837</td>
<td>137</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1028</td>
<td>Grumpier Old Men (1995)</td>
<td>Comedy Romance</td>
<td>NaN</td>
<td>6.704905</td>
<td>148</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1047</td>
<td>Multiplicity (1996)</td>
<td>Comedy</td>
<td>NaN</td>
<td>17.834051</td>
<td>134</td>
</tr>
</tbody>
</table>


<p>148 rows × 5 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-986f08c1-5fb2-4473-9762-3f86f493375d')" title="Convert this dataframe to an interactive table." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-986f08c1-5fb2-4473-9762-3f86f493375d button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-986f08c1-5fb2-4473-9762-3f86f493375d');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-d7c07e1f-d3c7-4862-8740-51f7ce1d2357">
  <button class="colab-df-quickchart" onclick="quickchart('df-d7c07e1f-d3c7-4862-8740-51f7ce1d2357')" title="Suggest charts." style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"></path>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-d7c07e1f-d3c7-4862-8740-51f7ce1d2357 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div>
</div>
<div class="cell" data-outputid="4f265aef-2f63-452e-9f9e-4c6553b393dc" data-execution_count="32">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>popular_movies_like[popular_movies_like.rating.isna()].sort_values(by<span class="op">=</span><span class="st">'predicted_rating'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">

  <div id="df-7919e7bd-3448-4bf8-9421-4b3fd5377e41" class="colab-df-container">
    <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">movie title</th>
<th data-quarto-table-cell-role="th">Genre</th>
<th data-quarto-table-cell-role="th">rating</th>
<th data-quarto-table-cell-role="th">predicted_rating</th>
<th data-quarto-table-cell-role="th">rating_count</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">movie id</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">699</td>
<td>Little Women (1994)</td>
<td>Drama</td>
<td>NaN</td>
<td>19.344744</td>
<td>102</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1047</td>
<td>Multiplicity (1996)</td>
<td>Comedy</td>
<td>NaN</td>
<td>17.834051</td>
<td>134</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">654</td>
<td>Chinatown (1974)</td>
<td>Film-Noir Mystery Thriller</td>
<td>NaN</td>
<td>17.403227</td>
<td>147</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">603</td>
<td>Rear Window (1954)</td>
<td>Mystery Thriller</td>
<td>NaN</td>
<td>14.505638</td>
<td>209</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">509</td>
<td>My Left Foot (1989)</td>
<td>Drama</td>
<td>NaN</td>
<td>13.487984</td>
<td>121</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">432</td>
<td>Fantasia (1940)</td>
<td>Animation Children's Musical</td>
<td>NaN</td>
<td>13.038412</td>
<td>174</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">879</td>
<td>Peacemaker, The (1997)</td>
<td>Action Thriller War</td>
<td>NaN</td>
<td>12.796140</td>
<td>136</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">462</td>
<td>Like Water For Chocolate (Como agua para choco...</td>
<td>Drama Romance</td>
<td>NaN</td>
<td>12.088273</td>
<td>148</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">347</td>
<td>Wag the Dog (1997)</td>
<td>Comedy Drama</td>
<td>NaN</td>
<td>10.813789</td>
<td>137</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">746</td>
<td>Real Genius (1985)</td>
<td>Comedy</td>
<td>NaN</td>
<td>10.662740</td>
<td>119</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">685</td>
<td>Executive Decision (1996)</td>
<td>Action Thriller</td>
<td>NaN</td>
<td>9.452888</td>
<td>157</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1016</td>
<td>Con Air (1997)</td>
<td>Action Adventure Thriller</td>
<td>NaN</td>
<td>9.294837</td>
<td>137</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">284</td>
<td>Tin Cup (1996)</td>
<td>Comedy Romance</td>
<td>NaN</td>
<td>8.969780</td>
<td>193</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">331</td>
<td>Edge, The (1997)</td>
<td>Adventure Thriller</td>
<td>NaN</td>
<td>8.816672</td>
<td>113</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">282</td>
<td>Time to Kill, A (1996)</td>
<td>Drama</td>
<td>NaN</td>
<td>8.118050</td>
<td>232</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">510</td>
<td>Magnificent Seven, The (1954)</td>
<td>Action Drama Western</td>
<td>NaN</td>
<td>7.821043</td>
<td>121</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">484</td>
<td>Maltese Falcon, The (1941)</td>
<td>Film-Noir Mystery</td>
<td>NaN</td>
<td>7.799504</td>
<td>138</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">443</td>
<td>Birds, The (1963)</td>
<td>Horror</td>
<td>NaN</td>
<td>7.776516</td>
<td>162</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">926</td>
<td>Down Periscope (1996)</td>
<td>Comedy</td>
<td>NaN</td>
<td>7.610969</td>
<td>101</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">531</td>
<td>Shine (1996)</td>
<td>Drama Romance</td>
<td>NaN</td>
<td>7.593473</td>
<td>129</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">474</td>
<td>Dr. Strangelove or: How I Learned to Stop Worr...</td>
<td>Sci-Fi War</td>
<td>NaN</td>
<td>7.569488</td>
<td>194</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">520</td>
<td>Great Escape, The (1963)</td>
<td>Adventure War</td>
<td>NaN</td>
<td>7.122478</td>
<td>124</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">508</td>
<td>People vs. Larry Flynt, The (1996)</td>
<td>Drama</td>
<td>NaN</td>
<td>7.101352</td>
<td>215</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">316</td>
<td>As Good As It Gets (1997)</td>
<td>Comedy Drama</td>
<td>NaN</td>
<td>7.008964</td>
<td>112</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">283</td>
<td>Emma (1996)</td>
<td>Drama Romance</td>
<td>NaN</td>
<td>6.868413</td>
<td>177</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">411</td>
<td>Nutty Professor, The (1996)</td>
<td>Comedy Fantasy Romance Sci-Fi</td>
<td>NaN</td>
<td>6.867234</td>
<td>163</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">470</td>
<td>Tombstone (1993)</td>
<td>Western</td>
<td>NaN</td>
<td>6.853379</td>
<td>108</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1028</td>
<td>Grumpier Old Men (1995)</td>
<td>Comedy Romance</td>
<td>NaN</td>
<td>6.704905</td>
<td>148</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">678</td>
<td>Volcano (1997)</td>
<td>Drama Thriller</td>
<td>NaN</td>
<td>6.396570</td>
<td>219</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">479</td>
<td>Vertigo (1958)</td>
<td>Mystery Thriller</td>
<td>NaN</td>
<td>6.278979</td>
<td>179</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">485</td>
<td>My Fair Lady (1964)</td>
<td>Musical Romance</td>
<td>NaN</td>
<td>6.200313</td>
<td>125</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">273</td>
<td>Heat (1995)</td>
<td>Action Crime Thriller</td>
<td>NaN</td>
<td>6.149239</td>
<td>223</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">657</td>
<td>Manchurian Candidate, The (1962)</td>
<td>Film-Noir Thriller</td>
<td>NaN</td>
<td>6.014978</td>
<td>131</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">285</td>
<td>Secrets &amp; Lies (1996)</td>
<td>Drama</td>
<td>NaN</td>
<td>5.939179</td>
<td>162</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">300</td>
<td>Air Force One (1997)</td>
<td>Action Thriller</td>
<td>NaN</td>
<td>5.901276</td>
<td>431</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">651</td>
<td>Glory (1989)</td>
<td>Action Drama War</td>
<td>NaN</td>
<td>5.842471</td>
<td>171</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">346</td>
<td>Jackie Brown (1997)</td>
<td>Crime Drama</td>
<td>NaN</td>
<td>5.776313</td>
<td>126</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">514</td>
<td>Annie Hall (1977)</td>
<td>Comedy Romance</td>
<td>NaN</td>
<td>5.769654</td>
<td>180</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">655</td>
<td>Stand by Me (1986)</td>
<td>Adventure Comedy Drama</td>
<td>NaN</td>
<td>5.690945</td>
<td>227</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">684</td>
<td>In the Line of Fire (1993)</td>
<td>Action Thriller</td>
<td>NaN</td>
<td>5.663084</td>
<td>169</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">431</td>
<td>Highlander (1986)</td>
<td>Action Adventure</td>
<td>NaN</td>
<td>5.634047</td>
<td>153</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">276</td>
<td>Leaving Las Vegas (1995)</td>
<td>Drama Romance</td>
<td>NaN</td>
<td>5.605335</td>
<td>298</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">313</td>
<td>Titanic (1997)</td>
<td>Action Drama Romance</td>
<td>NaN</td>
<td>5.530039</td>
<td>350</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">501</td>
<td>Dumbo (1941)</td>
<td>Animation Children's Musical</td>
<td>NaN</td>
<td>5.057417</td>
<td>123</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">318</td>
<td>Schindler's List (1993)</td>
<td>Drama War</td>
<td>NaN</td>
<td>5.040833</td>
<td>298</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">327</td>
<td>Cop Land (1997)</td>
<td>Crime Drama Mystery</td>
<td>NaN</td>
<td>5.024515</td>
<td>175</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">496</td>
<td>It's a Wonderful Life (1946)</td>
<td>Drama</td>
<td>NaN</td>
<td>5.020920</td>
<td>231</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">709</td>
<td>Strictly Ballroom (1992)</td>
<td>Comedy Romance</td>
<td>NaN</td>
<td>4.926482</td>
<td>104</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">597</td>
<td>Eraser (1996)</td>
<td>Action Thriller</td>
<td>NaN</td>
<td>4.674265</td>
<td>206</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">559</td>
<td>Interview with the Vampire (1994)</td>
<td>Drama Horror</td>
<td>NaN</td>
<td>4.656068</td>
<td>137</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">302</td>
<td>L.A. Confidential (1997)</td>
<td>Crime Film-Noir Mystery Thriller</td>
<td>NaN</td>
<td>4.578002</td>
<td>297</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">895</td>
<td>Scream 2 (1997)</td>
<td>Horror Thriller</td>
<td>NaN</td>
<td>4.546927</td>
<td>106</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">455</td>
<td>Jackie Chan's First Strike (1996)</td>
<td>Action</td>
<td>NaN</td>
<td>4.380564</td>
<td>145</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">298</td>
<td>Face/Off (1997)</td>
<td>Action Sci-Fi Thriller</td>
<td>NaN</td>
<td>4.297020</td>
<td>194</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">322</td>
<td>Murder at 1600 (1997)</td>
<td>Mystery Thriller</td>
<td>NaN</td>
<td>4.212541</td>
<td>218</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">546</td>
<td>Broken Arrow (1996)</td>
<td>Action Thriller</td>
<td>NaN</td>
<td>4.153325</td>
<td>254</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">815</td>
<td>One Fine Day (1996)</td>
<td>Drama Romance</td>
<td>NaN</td>
<td>4.146792</td>
<td>112</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">419</td>
<td>Mary Poppins (1964)</td>
<td>Children's Comedy Musical</td>
<td>NaN</td>
<td>4.102202</td>
<td>178</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">324</td>
<td>Lost Highway (1997)</td>
<td>Mystery</td>
<td>NaN</td>
<td>4.022839</td>
<td>125</td>
</tr>
</tbody>
</table>


</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-7919e7bd-3448-4bf8-9421-4b3fd5377e41')" title="Convert this dataframe to an interactive table." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-7919e7bd-3448-4bf8-9421-4b3fd5377e41 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-7919e7bd-3448-4bf8-9421-4b3fd5377e41');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-4d9f6c2b-a72c-4cff-bf49-7e47b8094c43">
  <button class="colab-df-quickchart" onclick="quickchart('df-4d9f6c2b-a72c-4cff-bf49-7e47b8094c43')" title="Suggest charts." style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"></path>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-4d9f6c2b-a72c-4cff-bf49-7e47b8094c43 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div>
</div>
</section>
<section id="visualize-embeddings" class="level1">
<h1>Visualize embeddings</h1>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.manifold <span class="im">import</span> TSNE</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-outputid="a9328684-f42b-4ab9-abbd-91089ba4c90a" data-execution_count="34">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>v_array <span class="op">=</span> v.detach().numpy()</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>v_array.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>(200, 1682)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>tsne <span class="op">=</span> TSNE(n_components<span class="op">=</span><span class="dv">2</span>, perplexity<span class="op">=</span><span class="dv">40</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>Xs <span class="op">=</span> tsne.fit_transform(v_array.T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-outputid="1c65b238-09bb-41e1-e0b4-55c866257b30" data-execution_count="36">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>Xs.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>(1682, 2)</code></pre>
</div>
</div>
<div class="cell" data-outputid="67ee5842-c785-481c-c5f1-791252cd8edb" data-execution_count="37">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.scatterplot(x<span class="op">=</span>Xs[:,<span class="dv">0</span>], y<span class="op">=</span>Xs[:,<span class="dv">1</span>], hue<span class="op">=</span>movies.Horror)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Feature 1'</span>)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Feature 2'</span>)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Movie embeddings'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<pre><code>Text(0.5, 1.0, 'Movie embeddings')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="SVD_movielens100k_files/figure-html/cell-40-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-outputid="94dddf2e-0322-471c-d9d2-efc4ef8948a1" data-execution_count="38">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>title <span class="op">=</span> <span class="st">'god'</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>predicted[predicted[<span class="st">'movie title'</span>].<span class="bu">str</span>.contains(title, case<span class="op">=</span><span class="va">False</span>, regex<span class="op">=</span><span class="va">False</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">

  <div id="df-c64aa159-3a5d-4fc1-a2d6-1a02d0c638fe" class="colab-df-container">
    <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">movie title</th>
<th data-quarto-table-cell-role="th">Genre</th>
<th data-quarto-table-cell-role="th">rating</th>
<th data-quarto-table-cell-role="th">predicted_rating</th>
<th data-quarto-table-cell-role="th">rating_count</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">movie id</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">127</td>
<td>Godfather, The (1972)</td>
<td>Action Crime Drama</td>
<td>5.0</td>
<td>4.994543</td>
<td>413</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">187</td>
<td>Godfather: Part II, The (1974)</td>
<td>Action Crime Drama</td>
<td>4.0</td>
<td>4.000909</td>
<td>209</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">336</td>
<td>Playing God (1997)</td>
<td>Crime Thriller</td>
<td>NaN</td>
<td>-0.603078</td>
<td>43</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">613</td>
<td>My Man Godfrey (1936)</td>
<td>Comedy</td>
<td>NaN</td>
<td>-0.266189</td>
<td>27</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1092</td>
<td>Dear God (1996)</td>
<td>Comedy</td>
<td>NaN</td>
<td>6.974932</td>
<td>12</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1572</td>
<td>Wend Kuuni (God's Gift) (1982)</td>
<td>Drama</td>
<td>NaN</td>
<td>2.421425</td>
<td>1</td>
</tr>
</tbody>
</table>


</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-c64aa159-3a5d-4fc1-a2d6-1a02d0c638fe')" title="Convert this dataframe to an interactive table." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-c64aa159-3a5d-4fc1-a2d6-1a02d0c638fe button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-c64aa159-3a5d-4fc1-a2d6-1a02d0c638fe');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-255436a4-1227-45e7-9285-40ccc4940687">
  <button class="colab-df-quickchart" onclick="quickchart('df-255436a4-1227-45e7-9285-40ccc4940687')" title="Suggest charts." style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"></path>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-255436a4-1227-45e7-9285-40ccc4940687 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div>
</div>
<div class="cell" data-outputid="24c0a07e-91af-43e7-f7de-cb0dee9d0bb2" data-execution_count="39">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>movie1<span class="op">=</span><span class="dv">127</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>movie2<span class="op">=</span><span class="dv">187</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.scatterplot(x<span class="op">=</span>Xs[:,<span class="dv">0</span>], y<span class="op">=</span>Xs[:,<span class="dv">1</span>])</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>ax.scatter(x <span class="op">=</span> Xs[movie1<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>], y <span class="op">=</span> Xs[movie1<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>], color<span class="op">=</span><span class="st">'red'</span>) <span class="co"># godfather</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>ax.scatter(x <span class="op">=</span> Xs[movie2<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>], y <span class="op">=</span> Xs[movie2<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>], color<span class="op">=</span><span class="st">'green'</span>) <span class="co"># goodfellas</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Feature 1'</span>)</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Feature 2'</span>)</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Movie embeddings'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<pre><code>Text(0.5, 1.0, 'Movie embeddings')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="SVD_movielens100k_files/figure-html/cell-42-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-outputid="7ad9ec5e-6f54-4add-d1b9-fd4779c7d9e6" data-execution_count="40">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>popular_index <span class="op">=</span> predicted[predicted.rating_count<span class="op">&gt;</span><span class="dv">300</span>].index.to_numpy()<span class="op">-</span><span class="dv">1</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>popular_index</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<pre><code>array([  0,   6,  49,  55,  68,  78,  97,  99, 116, 120, 126, 150, 167,
       171, 172, 173, 180, 194, 203, 209, 221, 236, 256, 257, 268, 285,
       287, 293, 299, 312, 404, 747])</code></pre>
</div>
</div>
<div class="cell" data-outputid="14ce01b2-0e43-4b67-a4b8-0830eac9fe2c" data-execution_count="41">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.scatterplot(x<span class="op">=</span>Xs[:,<span class="dv">0</span>], y<span class="op">=</span>Xs[:,<span class="dv">1</span>])</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>ax.scatter(x <span class="op">=</span> Xs[popular_index, <span class="dv">0</span>], y <span class="op">=</span> Xs[popular_index, <span class="dv">1</span>], color<span class="op">=</span><span class="st">'red'</span>) <span class="co"># godfather</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ax.scatter(x = Xs[182, 0], y = Xs[182, 1], color='green') # goodfellas</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Feature 1'</span>)</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Feature 2'</span>)</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Movie embeddings'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<pre><code>Text(0.5, 1.0, 'Movie embeddings')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="SVD_movielens100k_files/figure-html/cell-44-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-outputid="5efd9884-48c0-4588-b3d3-7f2c198a4f15" data-execution_count="42">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>unpop_index <span class="op">=</span> predicted[predicted.rating_count<span class="op">&lt;</span><span class="dv">2</span>].index.to_numpy()<span class="op">-</span><span class="dv">1</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>unpop_index</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<pre><code>array([ 598,  676,  710,  813,  829,  851,  856, 1121, 1129, 1155, 1200,
       1234, 1235, 1308, 1309, 1319, 1324, 1328, 1338, 1339, 1340, 1342,
       1347, 1348, 1351, 1362, 1363, 1365, 1372, 1413, 1446, 1451, 1452,
       1456, 1457, 1459, 1460, 1475, 1481, 1485, 1491, 1492, 1493, 1497,
       1504, 1506, 1509, 1514, 1519, 1524, 1525, 1532, 1535, 1542, 1545,
       1547, 1556, 1558, 1560, 1561, 1562, 1563, 1564, 1565, 1566, 1567,
       1568, 1569, 1570, 1571, 1573, 1574, 1575, 1576, 1578, 1579, 1580,
       1581, 1582, 1583, 1585, 1586, 1592, 1594, 1595, 1598, 1600, 1602,
       1603, 1605, 1612, 1613, 1615, 1617, 1618, 1620, 1623, 1624, 1625,
       1626, 1629, 1631, 1632, 1633, 1634, 1635, 1636, 1637, 1639, 1640,
       1644, 1646, 1647, 1648, 1649, 1650, 1652, 1653, 1654, 1656, 1658,
       1659, 1660, 1662, 1664, 1665, 1666, 1667, 1668, 1669, 1670, 1672,
       1673, 1674, 1675, 1676, 1677, 1678, 1679, 1680, 1681])</code></pre>
</div>
</div>
<div class="cell" data-outputid="c04490a6-e448-4f54-d550-33a2d7ef98e0" data-execution_count="43">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.scatterplot(x<span class="op">=</span>Xs[:,<span class="dv">0</span>], y<span class="op">=</span>Xs[:,<span class="dv">1</span>])</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>ax.scatter(x <span class="op">=</span> Xs[unpop_index, <span class="dv">0</span>], y <span class="op">=</span> Xs[unpop_index, <span class="dv">1</span>], color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Feature 1'</span>)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Feature 2'</span>)</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Movie embeddings'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<pre><code>Text(0.5, 1.0, 'Movie embeddings')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="SVD_movielens100k_files/figure-html/cell-46-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-outputid="4e8ccb94-714a-4fc1-9ec1-89a9ada70ab3" data-execution_count="44">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>predicted.iloc[Xs[:,<span class="dv">0</span>]<span class="op">&lt;-</span><span class="fl">1.9</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">

  <div id="df-4bbadb4d-89d1-4cf2-8927-2d4547988e0c" class="colab-df-container">
    <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">movie title</th>
<th data-quarto-table-cell-role="th">Genre</th>
<th data-quarto-table-cell-role="th">rating</th>
<th data-quarto-table-cell-role="th">predicted_rating</th>
<th data-quarto-table-cell-role="th">rating_count</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">movie id</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">17</td>
<td>From Dusk Till Dawn (1996)</td>
<td>Action Comedy Crime Horror Thriller</td>
<td>3.0</td>
<td>2.999887</td>
<td>92</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">60</td>
<td>Three Colors: Blue (1993)</td>
<td>Drama</td>
<td>5.0</td>
<td>4.999560</td>
<td>64</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">68</td>
<td>Crow, The (1994)</td>
<td>Action Romance Thriller</td>
<td>4.0</td>
<td>3.999771</td>
<td>134</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">207</td>
<td>Cyrano de Bergerac (1990)</td>
<td>Action Drama Romance</td>
<td>5.0</td>
<td>4.999604</td>
<td>66</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">236</td>
<td>Citizen Ruth (1996)</td>
<td>Comedy Drama</td>
<td>4.0</td>
<td>3.999710</td>
<td>45</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">306</td>
<td>Mrs. Brown (Her Majesty, Mrs. Brown) (1997)</td>
<td>Drama Romance</td>
<td>NaN</td>
<td>12.381192</td>
<td>96</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">424</td>
<td>Children of the Corn: The Gathering (1996)</td>
<td>Horror</td>
<td>NaN</td>
<td>-2.154618</td>
<td>19</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">430</td>
<td>Duck Soup (1933)</td>
<td>Comedy War</td>
<td>NaN</td>
<td>4.534112</td>
<td>93</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">437</td>
<td>Amityville 1992: It's About Time (1992)</td>
<td>Horror</td>
<td>NaN</td>
<td>8.218152</td>
<td>5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">482</td>
<td>Some Like It Hot (1959)</td>
<td>Comedy Crime</td>
<td>NaN</td>
<td>-3.593135</td>
<td>128</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">576</td>
<td>Cliffhanger (1993)</td>
<td>Action Adventure Crime</td>
<td>NaN</td>
<td>7.356203</td>
<td>93</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">583</td>
<td>Romeo Is Bleeding (1993)</td>
<td>Crime Thriller</td>
<td>NaN</td>
<td>4.346161</td>
<td>37</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">606</td>
<td>All About Eve (1950)</td>
<td>Drama</td>
<td>NaN</td>
<td>7.138236</td>
<td>66</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">666</td>
<td>Blood For Dracula (Andy Warhol's Dracula) (1974)</td>
<td>Horror</td>
<td>NaN</td>
<td>2.432793</td>
<td>5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">722</td>
<td>Nine Months (1995)</td>
<td>Comedy</td>
<td>NaN</td>
<td>0.738387</td>
<td>58</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">757</td>
<td>Across the Sea of Time (1995)</td>
<td>Documentary</td>
<td>NaN</td>
<td>11.691241</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">768</td>
<td>Casper (1995)</td>
<td>Adventure Children's</td>
<td>NaN</td>
<td>-17.041201</td>
<td>52</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">787</td>
<td>Roommates (1995)</td>
<td>Comedy Drama</td>
<td>NaN</td>
<td>1.709565</td>
<td>13</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">789</td>
<td>Swimming with Sharks (1995)</td>
<td>Comedy Drama</td>
<td>NaN</td>
<td>-0.200173</td>
<td>47</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">885</td>
<td>Phantoms (1998)</td>
<td>Horror</td>
<td>NaN</td>
<td>5.136772</td>
<td>13</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">921</td>
<td>Farewell My Concubine (1993)</td>
<td>Drama Romance</td>
<td>NaN</td>
<td>8.932340</td>
<td>46</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">931</td>
<td>Island of Dr. Moreau, The (1996)</td>
<td>Sci-Fi Thriller</td>
<td>NaN</td>
<td>-8.975256</td>
<td>57</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1065</td>
<td>Koyaanisqatsi (1983)</td>
<td>Documentary War</td>
<td>NaN</td>
<td>5.435384</td>
<td>53</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1154</td>
<td>Alphaville (1965)</td>
<td>Sci-Fi</td>
<td>NaN</td>
<td>-11.588543</td>
<td>12</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1158</td>
<td>Fille seule, La (A Single Girl) (1995)</td>
<td>Drama</td>
<td>NaN</td>
<td>-9.225943</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1160</td>
<td>Love! Valour! Compassion! (1997)</td>
<td>Drama Romance</td>
<td>NaN</td>
<td>3.348643</td>
<td>26</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1234</td>
<td>Chairman of the Board (1998)</td>
<td>Comedy</td>
<td>NaN</td>
<td>12.278373</td>
<td>8</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1276</td>
<td>Sunset Park (1996)</td>
<td>Drama</td>
<td>NaN</td>
<td>6.947076</td>
<td>8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1333</td>
<td>Midnight Dancers (Sibak) (1994)</td>
<td>Comedy Drama</td>
<td>NaN</td>
<td>-1.943883</td>
<td>5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1358</td>
<td>The Deadly Cure (1996)</td>
<td>Action</td>
<td>NaN</td>
<td>-0.213771</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1394</td>
<td>Swept from the Sea (1997)</td>
<td>Romance</td>
<td>NaN</td>
<td>-4.480890</td>
<td>7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1401</td>
<td>M. Butterfly (1993)</td>
<td>Drama</td>
<td>NaN</td>
<td>2.626964</td>
<td>18</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1489</td>
<td>Chasers (1994)</td>
<td>Comedy</td>
<td>NaN</td>
<td>7.122463</td>
<td>5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1493</td>
<td>Modern Affair, A (1995)</td>
<td>Romance</td>
<td>NaN</td>
<td>-1.658208</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1506</td>
<td>Nelly &amp; Monsieur Arnaud (1995)</td>
<td>Drama</td>
<td>NaN</td>
<td>-5.450854</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1627</td>
<td>Wife, The (1995)</td>
<td>Comedy Drama</td>
<td>NaN</td>
<td>-7.673751</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1655</td>
<td>Favor, The (1994)</td>
<td>Comedy Romance</td>
<td>NaN</td>
<td>-2.180350</td>
<td>1</td>
</tr>
</tbody>
</table>


</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-4bbadb4d-89d1-4cf2-8927-2d4547988e0c')" title="Convert this dataframe to an interactive table." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-4bbadb4d-89d1-4cf2-8927-2d4547988e0c button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-4bbadb4d-89d1-4cf2-8927-2d4547988e0c');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-c7a090ca-65e3-4c19-be0a-0a10ddd5d41e">
  <button class="colab-df-quickchart" onclick="quickchart('df-c7a090ca-65e3-4c19-be0a-0a10ddd5d41e')" title="Suggest charts." style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"></path>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-c7a090ca-65e3-4c19-be0a-0a10ddd5d41e button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div>
</div>
<div class="cell" data-outputid="21bf4bba-91dc-42b7-8482-44548b19190e" data-execution_count="45">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.scatterplot(x<span class="op">=</span>Xs[:,<span class="dv">0</span>], y<span class="op">=</span>Xs[:,<span class="dv">1</span>])</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>ax.scatter(x <span class="op">=</span> Xs[Xs[:,<span class="dv">0</span>]<span class="op">&lt;-</span><span class="fl">1.9</span>,<span class="dv">0</span>], y <span class="op">=</span> Xs[Xs[:,<span class="dv">0</span>]<span class="op">&lt;-</span><span class="fl">1.9</span>,<span class="dv">1</span>], color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Feature 1'</span>)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Feature 2'</span>)</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Movie embeddings'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">
<pre><code>Text(0.5, 1.0, 'Movie embeddings')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="SVD_movielens100k_files/figure-html/cell-48-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-outputid="d3f092ae-2cb6-4938-9fd3-b6ac9ea0f383" data-execution_count="46">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>predicted.iloc[Xs[:,<span class="dv">0</span>]<span class="op">&gt;</span><span class="fl">1.9</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">

  <div id="df-b30f6564-18eb-4dd4-b202-409603df8a4e" class="colab-df-container">
    <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">movie title</th>
<th data-quarto-table-cell-role="th">Genre</th>
<th data-quarto-table-cell-role="th">rating</th>
<th data-quarto-table-cell-role="th">predicted_rating</th>
<th data-quarto-table-cell-role="th">rating_count</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">movie id</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">680</td>
<td>Kull the Conqueror (1997)</td>
<td>Action Adventure</td>
<td>NaN</td>
<td>10.752586</td>
<td>34</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">693</td>
<td>Casino (1995)</td>
<td>Drama</td>
<td>NaN</td>
<td>5.206984</td>
<td>91</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">701</td>
<td>Wonderful, Horrible Life of Leni Riefenstahl, ...</td>
<td>Documentary</td>
<td>NaN</td>
<td>-4.857945</td>
<td>10</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">711</td>
<td>Substance of Fire, The (1996)</td>
<td>Drama</td>
<td>NaN</td>
<td>-12.256781</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">783</td>
<td>Milk Money (1994)</td>
<td>Comedy Romance</td>
<td>NaN</td>
<td>-3.346568</td>
<td>37</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">785</td>
<td>Only You (1994)</td>
<td>Comedy Romance</td>
<td>NaN</td>
<td>-4.774742</td>
<td>39</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">901</td>
<td>Mr. Magoo (1997)</td>
<td>Comedy</td>
<td>NaN</td>
<td>10.760063</td>
<td>12</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1248</td>
<td>Blink (1994)</td>
<td>Thriller</td>
<td>NaN</td>
<td>-5.151400</td>
<td>19</td>
</tr>
</tbody>
</table>


</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-b30f6564-18eb-4dd4-b202-409603df8a4e')" title="Convert this dataframe to an interactive table." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-b30f6564-18eb-4dd4-b202-409603df8a4e button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-b30f6564-18eb-4dd4-b202-409603df8a4e');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-9920d94f-fd6e-461a-b36c-59a3cfe6ff40">
  <button class="colab-df-quickchart" onclick="quickchart('df-9920d94f-fd6e-461a-b36c-59a3cfe6ff40')" title="Suggest charts." style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"></path>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-9920d94f-fd6e-461a-b36c-59a3cfe6ff40 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div>
</div>
<div class="cell" data-outputid="5a8ae474-df79-4c37-fff1-a5334c2eb70f" data-execution_count="47">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>most_watched <span class="op">=</span> predicted[predicted.rating_count<span class="op">&gt;</span><span class="dv">390</span>].index.to_numpy()<span class="op">-</span><span class="dv">1</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>most_watched</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="47">
<pre><code>array([  0,   6,  49,  55,  99, 120, 126, 173, 180, 257, 285, 287, 293,
       299])</code></pre>
</div>
</div>
<div class="cell" data-outputid="f9b80810-5150-461d-8f81-2aa6d99297bc" data-execution_count="48">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>titles <span class="op">=</span> predicted[predicted.rating_count<span class="op">&gt;</span><span class="dv">390</span>][<span class="st">'movie title'</span>].tolist()</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>titles</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">
<pre><code>['Toy Story (1995)',
 'Twelve Monkeys (1995)',
 'Star Wars (1977)',
 'Pulp Fiction (1994)',
 'Fargo (1996)',
 'Independence Day (ID4) (1996)',
 'Godfather, The (1972)',
 'Raiders of the Lost Ark (1981)',
 'Return of the Jedi (1983)',
 'Contact (1997)',
 'English Patient, The (1996)',
 'Scream (1996)',
 'Liar Liar (1997)',
 'Air Force One (1997)']</code></pre>
</div>
</div>
<div class="cell" data-outputid="e334054e-6817-4535-e92c-92a877a065f3" data-execution_count="49">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.scatterplot(x<span class="op">=</span>Xs[most_watched,<span class="dv">0</span>], y<span class="op">=</span>Xs[most_watched,<span class="dv">1</span>], hue<span class="op">=</span>titles, s<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ax.scatter(x = Xs[Xs[:,0]&lt;-1.9,0], y = Xs[Xs[:,0]&lt;-1.9,1], color='red')</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Feature 1'</span>)</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Feature 2'</span>)</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Movie embeddings'</span>)</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.legend(loc='lower right')</span></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>legend <span class="op">=</span> plt.legend(title<span class="op">=</span><span class="st">'Labels'</span>, loc<span class="op">=</span><span class="st">'upper left'</span>, labels<span class="op">=</span>titles, bbox_to_anchor<span class="op">=</span>(<span class="fl">1.05</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="SVD_movielens100k_files/figure-html/cell-52-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-outputid="230fc66f-550a-4049-b30a-7226a2984c7a" data-execution_count="50">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate r (radial distance)</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> np.sqrt((Xs<span class="op">**</span><span class="dv">2</span>).<span class="bu">sum</span>(<span class="op">-</span><span class="dv">1</span>))</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>r.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="50">
<pre><code>(1682,)</code></pre>
</div>
</div>
<div class="cell" data-outputid="34a932aa-cbb1-40a0-9783-2008de7c8693" data-execution_count="51">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate θ (polar angle) in radians</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>theta_rad <span class="op">=</span> np.arctan2(Xs[:,<span class="dv">1</span>], Xs[:,<span class="dv">0</span>])</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>theta_rad</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="51">
<pre><code>array([ 1.338102  , -2.5759    ,  2.6575549 , ...,  1.0303308 ,
        0.58894116,  1.3571696 ], dtype=float32)</code></pre>
</div>
</div>
<div class="cell" data-outputid="ecd65ee1-730d-4e4b-dca9-c88d07969b76" data-execution_count="52">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.scatterplot(x<span class="op">=</span>r, y<span class="op">=</span>theta_rad)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'r'</span>)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'theta'</span>)</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Movie embeddings'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="52">
<pre><code>Text(0.5, 1.0, 'Movie embeddings')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="SVD_movielens100k_files/figure-html/cell-55-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-outputid="d8eaf890-0931-4b56-c6bb-f491cbdcdf52" data-execution_count="53">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.scatterplot(x<span class="op">=</span>r, y<span class="op">=</span>theta_rad)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>ax.scatter(x <span class="op">=</span> r[r<span class="op">&gt;</span><span class="fl">1.8</span>], y <span class="op">=</span> theta_rad[r<span class="op">&gt;</span><span class="fl">1.8</span>], color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'r'</span>)</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'theta'</span>)</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Movie embeddings'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="53">
<pre><code>Text(0.5, 1.0, 'Movie embeddings')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="SVD_movielens100k_files/figure-html/cell-56-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-outputid="e6786a08-3f77-47c9-90e4-761a8204304a" data-execution_count="54">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>predicted.iloc[(r<span class="op">&gt;</span><span class="fl">1.8</span>)<span class="op">&amp;</span>(theta_rad<span class="op">&gt;</span><span class="dv">3</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="54">

  <div id="df-4b746472-a0ef-44d1-bd4d-02555779dd93" class="colab-df-container">
    <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">movie title</th>
<th data-quarto-table-cell-role="th">Genre</th>
<th data-quarto-table-cell-role="th">rating</th>
<th data-quarto-table-cell-role="th">predicted_rating</th>
<th data-quarto-table-cell-role="th">rating_count</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">movie id</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">60</td>
<td>Three Colors: Blue (1993)</td>
<td>Drama</td>
<td>5.0</td>
<td>4.999560</td>
<td>64</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">207</td>
<td>Cyrano de Bergerac (1990)</td>
<td>Action Drama Romance</td>
<td>5.0</td>
<td>4.999604</td>
<td>66</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">424</td>
<td>Children of the Corn: The Gathering (1996)</td>
<td>Horror</td>
<td>NaN</td>
<td>-2.154618</td>
<td>19</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">583</td>
<td>Romeo Is Bleeding (1993)</td>
<td>Crime Thriller</td>
<td>NaN</td>
<td>4.346161</td>
<td>37</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">722</td>
<td>Nine Months (1995)</td>
<td>Comedy</td>
<td>NaN</td>
<td>0.738387</td>
<td>58</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">768</td>
<td>Casper (1995)</td>
<td>Adventure Children's</td>
<td>NaN</td>
<td>-17.041201</td>
<td>52</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">789</td>
<td>Swimming with Sharks (1995)</td>
<td>Comedy Drama</td>
<td>NaN</td>
<td>-0.200173</td>
<td>47</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1276</td>
<td>Sunset Park (1996)</td>
<td>Drama</td>
<td>NaN</td>
<td>6.947076</td>
<td>8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1358</td>
<td>The Deadly Cure (1996)</td>
<td>Action</td>
<td>NaN</td>
<td>-0.213771</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1627</td>
<td>Wife, The (1995)</td>
<td>Comedy Drama</td>
<td>NaN</td>
<td>-7.673751</td>
<td>1</td>
</tr>
</tbody>
</table>


</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-4b746472-a0ef-44d1-bd4d-02555779dd93')" title="Convert this dataframe to an interactive table." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-4b746472-a0ef-44d1-bd4d-02555779dd93 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-4b746472-a0ef-44d1-bd4d-02555779dd93');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-3233740c-3a80-4b0f-9090-e1160afaaa7c">
  <button class="colab-df-quickchart" onclick="quickchart('df-3233740c-3a80-4b0f-9090-e1160afaaa7c')" title="Suggest charts." style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"></path>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-3233740c-3a80-4b0f-9090-e1160afaaa7c button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>