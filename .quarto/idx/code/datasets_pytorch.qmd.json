{"title":"Instantiate the custom dataset","markdown":{"yaml":{"title":"","format":{"html":{"code-fold":false}},"jupyter":"python3","execute":{"cache":true}},"headingText":"Instantiate the custom dataset","containsRefs":false,"markdown":"\n\n\nIn PyTorch, the `torch.utils.data.Dataset` class is used to represent a dataset. It provides an interface to access individual samples in the dataset, which can be used to train and evaluate machine learning models. This class is an abstract class, so we need to create a custom class that inherits from it and implements two methods: `__len__` and `__getitem__`.\n\nTo create a custom randomly generated dataset, we need to define a class that generates random samples and labels. Let's assume that we want to generate random 2D points along with their corresponding labels. The labels can be either 0 or 1, indicating two different classes.\n\nHere's an example implementation of the custom dataset class:\n\n```{python}\nimport torch\nfrom torch.utils.data import Dataset\n\nclass RandomDataset(Dataset):\n    def __init__(self, num_samples, num_features):\n        self.num_samples = num_samples\n        self.num_features = num_features\n        self.data = torch.randn(num_samples, num_features)\n        # Randomly assign labels of 0 or 1\n        self.targets = torch.randint(0, 2, (num_samples,))\n    \n    def __len__(self):\n        return self.num_samples\n    \n    def __getitem__(self, index):\n        sample = self.data[index]\n        label = self.targets[index]\n        return sample, label\n```\n\nLet's break down the code step by step:\n\n1. Import the necessary modules: `torch` and `torch.utils.data.Dataset`.\n\n2. Define a custom class called `RandomDataset` that inherits from `Dataset`.\n\n3. In the class constructor (`__init__` method), we pass the number of samples (`num_samples`) and the number of features (`num_features`) as parameters.\n\n4. Inside the constructor, we generate random data using `torch.randn` with dimensions (`num_samples`, `num_features`). This will create a tensor of random floating-point values.\n\n5. We also generate random labels using `torch.randint` with values between 0 and 1 (exclusive), and shape (`num_samples`,). This will create a tensor with integer labels.\n\n6. Implement the `__len__` method, which returns the number of samples in the dataset (`num_samples`).\n\n7. Implement the `__getitem__` method, which takes an index as input and returns the corresponding sample and label. This method is used to access individual samples in the dataset. Inside this method, we use the index to retrieve the sample and label from the data and targets tensors, respectively.\n\nNow, we can create an instance of the `RandomDataset` class and use it as a regular dataset in PyTorch.\n\n```{python}\ndataset = RandomDataset(num_samples=1000, num_features=2)\n\n# Access an individual sample and its label\nsample, label = dataset[0]\nprint(\"Sample:\", sample)\nprint(\"Label:\", label)\n```\n\nThis will output the first sample and its corresponding label from the dataset. You can access any sample by using the index in the same way.\n\nBy defining a custom dataset class, we can generate random datasets with specific characteristics and use them for training and evaluating machine learning models in PyTorch.","srcMarkdownNoYaml":"\n\n\nIn PyTorch, the `torch.utils.data.Dataset` class is used to represent a dataset. It provides an interface to access individual samples in the dataset, which can be used to train and evaluate machine learning models. This class is an abstract class, so we need to create a custom class that inherits from it and implements two methods: `__len__` and `__getitem__`.\n\nTo create a custom randomly generated dataset, we need to define a class that generates random samples and labels. Let's assume that we want to generate random 2D points along with their corresponding labels. The labels can be either 0 or 1, indicating two different classes.\n\nHere's an example implementation of the custom dataset class:\n\n```{python}\nimport torch\nfrom torch.utils.data import Dataset\n\nclass RandomDataset(Dataset):\n    def __init__(self, num_samples, num_features):\n        self.num_samples = num_samples\n        self.num_features = num_features\n        self.data = torch.randn(num_samples, num_features)\n        # Randomly assign labels of 0 or 1\n        self.targets = torch.randint(0, 2, (num_samples,))\n    \n    def __len__(self):\n        return self.num_samples\n    \n    def __getitem__(self, index):\n        sample = self.data[index]\n        label = self.targets[index]\n        return sample, label\n```\n\nLet's break down the code step by step:\n\n1. Import the necessary modules: `torch` and `torch.utils.data.Dataset`.\n\n2. Define a custom class called `RandomDataset` that inherits from `Dataset`.\n\n3. In the class constructor (`__init__` method), we pass the number of samples (`num_samples`) and the number of features (`num_features`) as parameters.\n\n4. Inside the constructor, we generate random data using `torch.randn` with dimensions (`num_samples`, `num_features`). This will create a tensor of random floating-point values.\n\n5. We also generate random labels using `torch.randint` with values between 0 and 1 (exclusive), and shape (`num_samples`,). This will create a tensor with integer labels.\n\n6. Implement the `__len__` method, which returns the number of samples in the dataset (`num_samples`).\n\n7. Implement the `__getitem__` method, which takes an index as input and returns the corresponding sample and label. This method is used to access individual samples in the dataset. Inside this method, we use the index to retrieve the sample and label from the data and targets tensors, respectively.\n\nNow, we can create an instance of the `RandomDataset` class and use it as a regular dataset in PyTorch.\n\n```{python}\n# Instantiate the custom dataset\ndataset = RandomDataset(num_samples=1000, num_features=2)\n\n# Access an individual sample and its label\nsample, label = dataset[0]\nprint(\"Sample:\", sample)\nprint(\"Label:\", label)\n```\n\nThis will output the first sample and its corresponding label from the dataset. You can access any sample by using the index in the same way.\n\nBy defining a custom dataset class, we can generate random datasets with specific characteristics and use them for training and evaluating machine learning models in PyTorch."},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":true,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"jupyter"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":false,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../styles.css"],"toc":true,"output-file":"datasets_pytorch.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.5.55","theme":"cosmo","title":"","jupyter":"python3"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}